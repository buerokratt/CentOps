get_dummy:
  call: http.post
  args:
    url: http://resql:8052/get-dummy
  result: results

toggle_value:
  switch:
    - condition: ${results.response.body[0].status === 'on'}
      next: set_off
  next: set_on

set_on:
  assign:
    newstatus: 'on'
  next: update-dummy

set_off:
  assign:
    newstatus: 'off'
  next: update-dummy

update-dummy:
  call: http.post
  args:
    url: http://resql:8052/update-dummy
    body:
      status: ${newstatus}
  result: results

return_value:
  wrapper: false
  status: 200
  return: 'ok'
